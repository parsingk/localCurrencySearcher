const greenMarker="/img/greenMarker.png",coffeeMarker="/img/coffee.png",dinnerMarker="/img/dinner.png",storeMarker="/img/store.png",martMarker="/img/mart.png",bakeryMarker="/img/bakery.png",hairMarker="/img/barbershop.png",green="lawngreen",apiUrl="/data";let centerLat=37.394914,centerLng=127.1100797,container=document.getElementById("map"),options={center:new kakao.maps.LatLng(centerLat,centerLng),level:5},map=new kakao.maps.Map(container,options),markers=[],circle=null,g_overlay=null;function setCurrentPosition(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(a){centerLat=a.coords.latitude,centerLng=a.coords.longitude;let b=new kakao.maps.LatLng(centerLat,centerLng),c="?lat="+centerLat+"&lng="+centerLng;httpGetAsync(apiUrl+c,displayMarker),map.setCenter(b)})}kakao.maps.event.addListener(map,"dragend",function(){let a=map.getCenter();centerLat=a.getLat(),centerLng=a.getLng()});function isMarkerOnMap(a,b,c=[]){let d=c.find(c=>c.lat==a&&c.lng==b);return void 0===d?parseFloat(b.toFixed(7)):(b+=65e-6,isMarkerOnMap(a,b,c))}function getMarkerImg(a){return 1===a||5===a||6===a?dinnerMarker:2===a?storeMarker:3===a?coffeeMarker:4===a?bakeryMarker:101===a?hairMarker:102===a?martMarker:greenMarker}function displayMarker(a,b){let c=[],d=null,e=null,f=null;markers.forEach(function(a){a.setMap(null)}),markers=[],b&&map.setLevel(9),a.forEach(function(a){d=a.geo_location.y,e=a.geo_location.x,e=isMarkerOnMap(d,e,c);let b=a.type,g=getMarkerImg(b);f=0<b?new kakao.maps.Size(22,26):new kakao.maps.Size(22,33);let h=new kakao.maps.MarkerImage(g,f),i=new kakao.maps.Marker({map:map,position:new kakao.maps.LatLng(d,e),image:h}),j=new kakao.maps.CustomOverlay({position:i.getPosition()}),k=getOverlayContent(a,j);j.setContent(k),c.push({lat:d,lng:e}),markers.push(i),kakao.maps.event.addListener(i,"click",function(){null!=g_overlay&&g_overlay.setMap(null),j.setMap(map),g_overlay=j})})}function getOverlayContent(a,b){let c=document.createElement("div");c.classList.add("wrap");let d=document.createElement("div");d.classList.add("info");let e=document.createElement("div");e.classList.add("title"),e.style.backgroundColor=green,e.style.color="black",e.appendChild(document.createTextNode(a.name));let f=document.createElement("div");f.classList.add("close"),f.onclick=function(){b.setMap(null)};let g=document.createElement("div");return g.classList.add("body"),g.appendChild(document.createTextNode("tel : "+a.tel)),c.appendChild(d),d.appendChild(e),d.appendChild(g),e.appendChild(f),c}function displayCircle(){null!=circle&&circle.setMap(null),circle=new kakao.maps.Circle({center:new kakao.maps.LatLng(centerLat,centerLng),radius:700,strokeWeight:1,strokeColor:"#75B8FA",strokeOpacity:1,strokeStyle:"solid",fillColor:"#CFE7FF",fillOpacity:.5}),circle.setMap(map)}function httpGetAsync(a,b,c){$("#loading").modal("show");let d=new XMLHttpRequest;d.onreadystatechange=function(){4==d.readyState&&200==d.status&&(b(JSON.parse(d.responseText),c),$("#loading").modal("hide"))},d.open("GET",a,!0),d.send()}document.addEventListener("DOMContentLoaded",function(){$("#alertModal").modal("show"),setCurrentPosition(),$("#searchText").keypress(function(a){if(13==a.keyCode){let a=$("#searchText").val();if(0===a.length)return;httpGetAsync(apiUrl+"?search="+a,displayMarker,!0),null!=circle&&circle.setMap(null),$("#searchText").blur()}}),$("#btn-search").click(function(){let a=$("#searchText").val();0===a.length||(httpGetAsync(apiUrl+"?search="+a,displayMarker,!0),null!=circle&&circle.setMap(null))}),$("#location").click(function(){let a="?lat="+centerLat+"&lng="+centerLng;httpGetAsync(apiUrl+a,displayMarker),displayCircle()}),$("#dinner").click(function(){let a="?lat="+centerLat+"&lng="+centerLng+"&type=1";httpGetAsync(apiUrl+a,displayMarker),displayCircle()}),$("#mart").click(function(){let a="?lat="+centerLat+"&lng="+centerLng+"&type=102";httpGetAsync(apiUrl+a,displayMarker),displayCircle()}),$("#cafe").click(function(){let a="?lat="+centerLat+"&lng="+centerLng+"&type=3";httpGetAsync(apiUrl+a,displayMarker),displayCircle()}),$("#store").click(function(){let a="?lat="+centerLat+"&lng="+centerLng+"&type=2";httpGetAsync(apiUrl+a,displayMarker),displayCircle()}),$("#bakery").click(function(){let a="?lat="+centerLat+"&lng="+centerLng+"&type=4";httpGetAsync(apiUrl+a,displayMarker),displayCircle()}),$("#hair").click(function(){let a="?lat="+centerLat+"&lng="+centerLng+"&type=101";httpGetAsync(apiUrl+a,displayMarker),displayCircle()})});